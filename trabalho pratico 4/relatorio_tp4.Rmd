---
title: "Relatório trabalho prático 4"
author:
- César A. Galvão 19/0011572
- Gabriela Carneiro 18/0120816
date: "`r format(Sys.Date(), '%d de %B de %Y')`"
output:
  pdf_document: 
    toc: true
    toc_depth: 2
    number_sections: true
    keep_tex: yes
latex_engine: pdflatex
header-includes:
  \usepackage{helvet}
  \renewcommand\familydefault{\sfdefault}
include-before:
- '`\newpage{}`{=latex}'
---

\let\oldsection\section
\renewcommand\section{\clearpage\oldsection}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
library(broom)
getwd()
list.files()
source("programa.R", encoding = "UTF-8")
```


\begin{center} 

\textbf{Resumo} 

\end{center}

Nesta atividade foram implementadas em R um algoritmo EM e um método MCMC. Para cada algoritmo, foram estimados três parâmetros: probabilidade de o lote vir da máquina A ($p$) e a probabilidade de que, dado que uma determinada peça tenha sido produzida pela máquina A ou B, a peça seja defeituosa ($\theta_A$, $\theta_B$). Por fim, são apresentados histogramas com a função de probabilidade conjunta obtida pelos parâmetros estimados sobreposta em formato de pontos.^[Todos os documentos desse relatório podem ser verificados no repositório https://github.com/cesar-galvao/Estatistica-computacional]


# Introdução

# Método

## Método EM  

## Amostrador de Gibbs  


# Resultados

Para o método EM, obteve-se a seguinte estimativa final para os parâmetros ao final de `r contador` iterações:

```{r tabela-parametros-EM, echo = FALSE}
data.frame(ta = thetaA, tb = thetaB, p = p) %>%  
knitr::kable(
    format = "latex",
    align = "c",
    booktabs = TRUE,
    longtable = TRUE,
    linesep = "",
    col.names = c("$\\theta_A$", "$\\theta_B$", "$p$"),
    escape = FALSE
    ) %>%
  kableExtra::kable_styling(
      position = "center",
      latex_options = c("striped", "repeat_header"),
      stripe_color = "gray!15")
```

A função de distribuição conjunta, com os parâmetros obtidos pelo algoritmo EM, é

\begin{align}
  P(y) = (1-p)P(y|\theta_A) + p P(y|\theta_B).
\end{align}

Além disso, obteve-se o seguinte histograma com a função de distribuição conjunta, representada por pontos:

```{r histograma-EM, echo = FALSE, out.width="60%", fig.margin=TRUE, fig.align='center', fig.cap="Histograma de da amostra e função de distribuição conjunta com parâmetros obtidos pelo algoritmo EM."}
histograma_em
```

Para o amostrador de Gibbs, 


# Anexo A - código comentado {.unnumbered}


```{r codigo-comentado, eval = FALSE}

```


